/*
 * Copyright (c) 2025 EdgeImpulse Inc.
 *
 * Generated by Edge Impulse and licensed under the applicable Edge Impulse
 * Terms of Service. Community and Professional Terms of Service
 * (https://edgeimpulse.com/legal/terms-of-service) or Enterprise Terms of
 * Service (https://edgeimpulse.com/legal/enterprise-terms-of-service),
 * according to your product plan subscription (the “License”).
 *
 * This software, documentation and other associated files (collectively referred
 * to as the “Software”) is a single SDK variation generated by the Edge Impulse
 * platform and requires an active paid Edge Impulse subscription to use this
 * Software for any purpose.
 *
 * You may NOT use this Software unless you have an active Edge Impulse subscription
 * that meets the eligibility requirements for the applicable License, subject to
 * your full and continued compliance with the terms and conditions of the License,
 * including without limitation any usage restrictions under the applicable License.
 *
 * If you do not have an active Edge Impulse product plan subscription, or if use
 * of this Software exceeds the usage limitations of your Edge Impulse product plan
 * subscription, you are not permitted to use this Software and must immediately
 * delete and erase all copies of this Software within your control or possession.
 * Edge Impulse reserves all rights and remedies available to enforce its rights.
 *
 * Unless required by applicable law or agreed to in writing, the Software is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific language governing
 * permissions, disclaimers and limitations under the License.
 */

#ifndef _EI_CLASSIFIER_MODEL_VARIABLES_H_
#define _EI_CLASSIFIER_MODEL_VARIABLES_H_

/**
 * @file
 *  Auto-generated complete impulse definitions. The ei_impulse_handle_t should
 *  be passed to ei_run_classifier() function to use this specific impulse.
 *  This file should only be included in ei_run_classifier.h file.
 */

#include <stdint.h>
#include "model_metadata.h"
#include "tflite-model/tflite_learn_840915_110.h"
#include "edge-impulse-sdk/classifier/ei_model_types.h"
#include "edge-impulse-sdk/classifier/inferencing_engines/engines.h"
#include "edge-impulse-sdk/classifier/postprocessing/ei_postprocessing_common.h"

const char* ei_classifier_inferencing_categories_840915_4[] = { "Leak", "No_leak" };

EI_CLASSIFIER_DSP_AXES_INDEX_TYPE ei_dsp_config_840915_76_axes[] = { 0 };
const uint32_t ei_dsp_config_840915_76_axes_size = 1;
ei_dsp_config_spectral_analysis_t ei_dsp_config_840915_76 = {
    76, // uint32_t blockId
    4, // int implementationVersion
    1, // int length of axes
    1.0f, // float scale-axes
    3, // int input-decimation-ratio
    "high", // select filter-type
    500.0f, // float filter-cutoff
    6, // int filter-order
    "Wavelet", // select analysis-type
    2048, // int fft-length
    3, // int spectral-peaks-count
    0.1f, // float spectral-peaks-threshold
    "0.1, 0.5, 1.0, 2.0, 5.0", // string spectral-power-edges
    true, // boolean do-log
    false, // boolean do-fft-overlap
    6, // int wavelet-level
    "bior3.1", // select wavelet
    false // boolean extra-low-freq
};

const float ei_dn_standard_scaler_mean_840915_76[98] = { 3.1151813030958984, 0.6435256599134613, 0.6381769835847761, -29484.346368425537, -9507.15665647326, 9533.13937946143, 29440.444495679563, 18.185157888065408, -7.562550384461232, 21059.18664590383, 1014312277.8942208, 21061.239993842846, 0.034641072485931575, 59.8372968001995, 3.550931391352678, 0.3948364319689873, 0.38640529058969, -20201.729625627184, -6047.37503031624, 6079.899304669947, 20309.522780490875, 30.75731741630032, 25.68406501618114, 13070.870932613163, 447198298.1562655, 13093.067105575965, -0.013967643267128738, 18.173260602519612, 3.6478982528637083, 0.3827424801265362, 0.3778554147610927, -14157.133984974951, -4615.39931796361, 4649.528686329975, 14239.443691812068, 20.048690351344938, 16.237029720405708, 9033.833809255091, 219820546.4934626, 9041.857906639934, 0.018147371057454863, 9.449537132405746, 3.5808822803956217, 0.4328614713341488, 0.4278398545030344, -9856.326819475651, -3265.195493280389, 3243.1884649272693, 9885.264205369727, -4.405236792410317, -6.723164498805513, 6223.500375487407, 99374848.32034375, 6226.322733587433, -0.004138121424235439, 20.98191199440826, 3.507191533658174, 0.4910584014054066, 0.4869559216691285, -4804.679696209346, -1666.5110905986287, 1667.5111384978802, 4820.724013178926, 7.726898362239774, 4.689407340316325, 3086.748872627973, 27577602.662083272, 3087.4219223790456, -0.06346313115859331, 32.928980759637575, 3.4081755969512866, 0.4851823738226694, 0.48313107807359484, -1612.1352260324156, -586.8987341589227, 588.8027690655697, 1612.9035762688002, 0.5235130052255784, 0.36265843791750835, 1032.1270638796339, 3205860.871614113, 1032.2374617007436, -0.05746348147419813, 38.870928080286966, 3.2838400815058764, 0.5678455002175887, 0.5677769648698765, -378.91905815064706, -142.01358458283437, 142.43230285000706, 378.7487846984263, -0.16110574904670566, -0.020474188360451825, 240.44151667297103, 232365.0228765893, 240.44164459443766, -0.05424716665992455, 50.699085418683715 };
const float ei_dn_standard_scaler_scale_840915_76[98] = { 1.2317123847891118, 17.67728328090492, 15.42405765411568, 0.000026422850328310767, 0.0000856627067001903, 0.00008536839279280688, 0.00002656309075053094, 0.0015020411597105252, 0.00240948835625558, 0.000041929462288106834, 4.3390280934593043e-10, 0.00004192629960108497, 0.16635548946291076, 0.009720380083582492, 1.5313698375364437, 15.0361734025131, 13.626259525109695, 0.000036974668665066624, 0.00013088912265667057, 0.00012990306047666543, 0.000036896157787370166, 0.001266890954120186, 0.0008046831862613478, 0.000060251919495371224, 8.687083348128039e-10, 0.00006014673544214914, 0.30990817603857634, 0.016330294286093252, 1.689302701156078, 11.892985661493443, 11.193717277786858, 0.00005136976044963521, 0.00015563054008698986, 0.0001548238556207896, 0.00005104339723198507, 0.002079295863364138, 0.0018331065190831729, 0.00008512842564252176, 1.5231346010046283e-9, 0.00008508132728782665, 0.5570106083161173, 0.023867778374619224, 1.5350396224727367, 8.317484009641577, 7.91896357666515, 0.00007686207796639255, 0.0002217737722842968, 0.00022538190829759426, 0.00007665150999397876, 0.004458540572098362, 0.003303263914029887, 0.00012846589912687614, 4.035770049476015e-9, 0.0001284059914075794, 0.3017887123519965, 0.008048764597318011, 1.470704015048535, 7.426059480176897, 7.241340800869224, 0.00014475864398496817, 0.000387934556580315, 0.00039083840204230127, 0.00014426615140739708, 0.008819027110389106, 0.010505796170462529, 0.0002354232327917759, 1.4722856514872424e-8, 0.00023539109700454266, 0.22354406478807842, 0.003937256988983992, 1.4281387814350397, 9.549904820667882, 9.424372506915196, 0.00042521389121136693, 0.0010116371924986528, 0.0010094237661213991, 0.0004249437892455887, 0.029949346643619538, 0.03546711191796618, 0.0006835581467098712, 1.1681826363828719e-7, 0.0006834675827091382, 0.22898008371476544, 0.0031508319905707337, 1.3725911925522651, 6.62373758892505, 6.618992545698865, 0.0014873941383221074, 0.003404404610506556, 0.0033940919332617783, 0.001487197447101354, 0.2725107360940726, 2.1154433533793404, 0.002393616287111835, 0.0000011428438536391552, 0.0023936151843381255, 0.24128527095944804, 0.002513122339394328 };
const float ei_dn_standard_scaler_var_840915_76[98] = { 0.6591456396545113, 0.003200139841570865, 0.0042034193598617505, 1432322026.2621665, 136275070.2192233, 137216326.91006276, 1417237998.558459, 443237.3327857958, 172246.47231802554, 568802392.0077658, 5311474196165411000, 568888209.8267239, 36.1348059713388, 10583.602157620133, 0.4264222156505605, 0.00442308564711987, 0.005385756168477429, 731461408.9042559, 58370429.19605272, 59259943.61519709, 734577656.2581081, 623048.0334891053, 1544365.695436074, 275459798.6553007, 1325110280263020000, 276424084.1687624, 10.411994547064555, 3749.8334398456313, 0.35041690302753425, 0.007069980393759902, 0.007980890141955516, 378952624.3283912, 41286717.038358375, 41718073.294394545, 383814039.8035922, 231295.62648272488, 297594.2914668923, 137991011.04093817, 431045813916788350, 138143828.3194804, 3.2230947084002928, 1755.3996480328694, 0.424385776666987, 0.0144549319270559, 0.01594642406462898, 169268348.5686311, 20331978.068292797, 19686200.163048364, 170199613.96386185, 50305.39390217875, 91645.98725136508, 60593254.35587761, 61397003250091620, 60649807.020144716, 10.979789546028242, 15436.240932269731, 0.4623271988781048, 0.018133563318113246, 0.019070497616908016, 47721159.519224994, 6644817.612002913, 6546445.27925159, 48047534.52084246, 12857.562517623868, 9060.28917028875, 18042693.095170856, 4613344013575192, 18047619.83821501, 20.01122673765573, 64507.83624899671, 0.49029693081833475, 0.010964830274854476, 0.011258877986394165, 5530763.806039455, 977125.6743534728, 981415.5812541301, 5537796.947737485, 1114.8727358464325, 794.9656240152225, 2140173.9459385714, 73278826629944.34, 2140741.1580818007, 19.072366355525034, 100727.83685858916, 0.5307837083065531, 0.022792594413698908, 0.022825285374171424, 452009.81861732324, 86281.49469869307, 86806.61010943745, 452129.38880943536, 13.465818804959403, 0.22345866463113218, 174538.3786729498, 765642805786.2328, 174538.53949778152, 17.17664645816385, 158333.47324405567 };
ei_data_normalization_standard_scaler_config_t ei_data_normalization_standard_scaler_config_840915_76 = {
    .mean_data = (float *)ei_dn_standard_scaler_mean_840915_76,
    .mean_data_len = 98,
    .scale_data = (float *)ei_dn_standard_scaler_scale_840915_76,
    .scale_data_len = 98,
    .var_data = (float *)ei_dn_standard_scaler_var_840915_76,
    .var_data_len = 98
};
ei_data_normalization_t ei_data_normalization_config_840915_76 = {
    (void *) &ei_data_normalization_standard_scaler_config_840915_76, // config
    DATA_NORMALIZATION_METHOD_STANDARD_SCALER, // method
    nullptr, // context
    nullptr, // init func
    nullptr, // deinit func
    &data_normalization_standard_scaler // exec func
};

const uint8_t ei_dsp_blocks_840915_4_size = 1;
ei_model_dsp_t ei_dsp_blocks_840915_4[ei_dsp_blocks_840915_4_size] = {
    { // DSP block 76
        76,
        98, // output size
        &extract_spectral_analysis_features, // DSP function pointer
        (void*)&ei_dsp_config_840915_76, // pointer to config struct
        ei_dsp_config_840915_76_axes, // array of offsets into the input stream, one for each axis
        ei_dsp_config_840915_76_axes_size, // number of axes
        1, // version
        nullptr, // factory function
        &ei_data_normalization_config_840915_76, // data normalization config
    }
};
const ei_config_tflite_graph_t ei_config_graph_840915_110 = {
    .implementation_version = 1,
    .model = tflite_learn_840915_110,
    .model_size = tflite_learn_840915_110_len,
    .arena_size = tflite_learn_840915_110_arena_size
};

const uint8_t ei_output_tensors_indices_840915_110[1] = { 0 };
const uint8_t ei_output_tensors_size_840915_110 = 1;
ei_learning_block_config_tflite_graph_t ei_learning_block_config_840915_110 = {
    .implementation_version = 1,
    .block_id = 110,
    .output_tensors_indices = ei_output_tensors_indices_840915_110,
    .output_tensors_size = ei_output_tensors_size_840915_110,
    .quantized = 0,
    .compiled = 0,
    .graph_config = (void*)&ei_config_graph_840915_110,
    .dequantize_output = 0,
};

const uint8_t ei_learning_blocks_840915_4_size = 1;
const uint32_t ei_learning_block_840915_110_inputs[1] = { 76 };
const uint8_t ei_learning_block_840915_110_inputs_size = 1;
const ei_learning_block_t ei_learning_blocks_840915_4[ei_learning_blocks_840915_4_size] = {
    {
        110,
        &run_nn_inference,
        (void*)&ei_learning_block_config_840915_110,
        EI_CLASSIFIER_IMAGE_SCALING_NONE,
        ei_learning_block_840915_110_inputs,
        ei_learning_block_840915_110_inputs_size,
    },
};

const size_t ei_postprocessing_blocks_840915_4_size = 1;
const ei_postprocessing_block_t ei_postprocessing_blocks_840915_4[ei_postprocessing_blocks_840915_4_size] = {
    {
        .block_id = 110,
        .type = EI_CLASSIFIER_MODE_CLASSIFICATION,
        .init_fn = NULL,
        .deinit_fn = NULL,
        .postprocess_fn = &process_classification_f32,
        .display_fn = NULL,
        .config = NULL,
        .input_block_id = 110
    },
};

const uint8_t freeform_outputs_840915_4_size = 0;

uint32_t *freeform_outputs_840915_4 = nullptr;

const ei_impulse_t impulse_840915_4 = {
    .project_id = 840915,
    .project_owner = "Suporte",
    .project_name = "Sane.AI.WAVELET",
    .impulse_id = 4,
    .impulse_name = "spectrogram",
    .deploy_version = 3,

    .nn_input_frame_size = 98,
    .raw_sample_count = 96000,
    .raw_samples_per_frame = 1,
    .dsp_input_frame_size = 96000 * 1,
    .input_width = 0,
    .input_height = 0,
    .input_frames = 0,
    .interval_ms = 0.020833333333333332,
    .frequency = 48000,

    .dsp_blocks_size = ei_dsp_blocks_840915_4_size,
    .dsp_blocks = ei_dsp_blocks_840915_4,

    .learning_blocks_size = ei_learning_blocks_840915_4_size,
    .learning_blocks = ei_learning_blocks_840915_4,

    .postprocessing_blocks_size = ei_postprocessing_blocks_840915_4_size,
    .postprocessing_blocks = ei_postprocessing_blocks_840915_4,

    .output_tensors_size = 1,

    .inferencing_engine = EI_CLASSIFIER_TFLITE,

    .sensor = EI_CLASSIFIER_SENSOR_MICROPHONE,
    .fusion_string = "audio",
    .slice_size = (96000/4),
    .slices_per_model_window = 4,

    .has_anomaly = EI_ANOMALY_TYPE_UNKNOWN,
    .label_count = 2,
    .categories = ei_classifier_inferencing_categories_840915_4,
    .results_type = EI_CLASSIFIER_TYPE_CLASSIFICATION,
    .freeform_outputs_size = freeform_outputs_840915_4_size,
    .freeform_outputs = freeform_outputs_840915_4
};

ei_impulse_handle_t impulse_handle_840915_4 = ei_impulse_handle_t( &impulse_840915_4 );

ei_impulse_handle_t& ei_default_impulse = impulse_handle_840915_4;
constexpr auto& ei_classifier_inferencing_categories = ei_classifier_inferencing_categories_840915_4;
const auto ei_dsp_blocks_size = ei_dsp_blocks_840915_4_size;
ei_model_dsp_t *ei_dsp_blocks = ei_dsp_blocks_840915_4;
#endif // _EI_CLASSIFIER_MODEL_VARIABLES_H_
